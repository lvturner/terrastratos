<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Modal Test Suite</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .test-results {
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .test-section {
            margin-bottom: 2rem;
            padding: 1rem;
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .test-result {
            padding: 0.5rem;
            margin: 0.25rem 0;
            border-radius: 3px;
        }
        
        .test-pass {
            background: #d4edda;
            color: #155724;
        }
        
        .test-fail {
            background: #f8d7da;
            color: #721c24;
        }
        
        .test-info {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .test-controls {
            text-align: center;
            margin: 2rem 0;
        }
        
        .test-controls button {
            margin: 0.5rem;
        }
    </style>
</head>
<body>
    <h1>Comprehensive Modal Test Suite</h1>
    
    <div class="test-controls">
        <button class="cta-button" onclick="runAllTests()">Run All Tests</button>
        <button class="cta-button" onclick="clearResults()">Clear Results</button>
    </div>

    <div class="test-results">
        <div class="test-section">
            <h3>Modal Functionality Tests</h3>
            <div id="modal-tests"></div>
        </div>
        
        <div class="test-section">
            <h3>Form Validation Tests</h3>
            <div id="form-tests"></div>
        </div>
        
        <div class="test-section">
            <h3>Accessibility Tests</h3>
            <div id="accessibility-tests"></div>
        </div>
        
        <div class="test-section">
            <h3>Responsive Design Tests</h3>
            <div id="responsive-tests"></div>
        </div>
    </div>

    <!-- Test Modal -->
    <button id="test-trigger" class="cta-button">Test Contact Form</button>
    
    <!-- Contact Modal -->
    <div class="modal-overlay" id="contact-modal" role="dialog" aria-labelledby="contact-modal-title" aria-hidden="true">
        <div class="modal-container">
            <button class="modal-close" id="modal-close" aria-label="Close contact form">
                <span aria-hidden="true">&times;</span>
            </button>
            
            <h2 id="contact-modal-title">Get in Touch</h2>
            
            <form id="contact-form" action="https://formspree.io/f/xzzvkzkg" method="POST" class="contact-form">
                <div class="form-group">
                    <label for="contact-email">Email Address</label>
                    <input
                        type="email"
                        id="contact-email"
                        name="email"
                        required
                        aria-required="true"
                        placeholder="your.email@example.com"
                    >
                </div>
                
                <div class="form-group">
                    <label for="contact-message">Message</label>
                    <textarea
                        id="contact-message"
                        name="message"
                        required
                        aria-required="true"
                        rows="5"
                        placeholder="Tell us about your project..."
                    ></textarea>
                </div>
                
                <button type="submit" class="cta-button">Send Message</button>
            </form>
            
            <div id="form-status" class="form-status" style="display: none;" role="status" aria-live="polite"></div>
        </div>
    </div>

    <script src="modal.js"></script>
    <script>
        class ModalTester {
            constructor() {
                this.results = {
                    modal: [],
                    form: [],
                    accessibility: [],
                    responsive: []
                };
            }

            log(section, message, type = 'info') {
                const div = document.createElement('div');
                div.className = `test-result test-${type}`;
                div.textContent = message;
                document.getElementById(`${section}-tests`).appendChild(div);
                this.results[section].push({ message, type });
            }

            async testModalOpenClose() {
                try {
                    // Test modal opening
                    const trigger = document.getElementById('test-trigger');
                    const modal = document.getElementById('contact-modal');
                    
                    trigger.click();
                    await this.wait(100);
                    
                    if (modal.classList.contains('is-open')) {
                        this.log('modal', '✓ Modal opens correctly', 'pass');
                    } else {
                        this.log('modal', '✗ Modal failed to open', 'fail');
                    }

                    // Test close button
                    const closeBtn = document.getElementById('modal-close');
                    closeBtn.click();
                    await this.wait(100);
                    
                    if (!modal.classList.contains('is-open')) {
                        this.log('modal', '✓ Modal closes with close button', 'pass');
                    } else {
                        this.log('modal', '✗ Modal failed to close with button', 'fail');
                    }

                    // Test Escape key
                    trigger.click();
                    await this.wait(100);
                    
                    const escapeEvent = new KeyboardEvent('keydown', { key: 'Escape' });
                    document.dispatchEvent(escapeEvent);
                    await this.wait(100);
                    
                    if (!modal.classList.contains('is-open')) {
                        this.log('modal', '✓ Modal closes with Escape key', 'pass');
                    } else {
                        this.log('modal', '✗ Modal failed to close with Escape', 'fail');
                    }

                } catch (error) {
                    this.log('modal', `✗ Error in open/close test: ${error.message}`, 'fail');
                }
            }

            async testFormValidation() {
                try {
                    const form = document.getElementById('contact-form');
                    const email = document.getElementById('contact-email');
                    const message = document.getElementById('contact-message');

                    // Test empty form submission
                    const submitEvent = new Event('submit', { cancelable: true });
                    form.dispatchEvent(submitEvent);
                    
                    if (submitEvent.defaultPrevented) {
                        this.log('form', '✓ Form prevents empty submission', 'pass');
                    } else {
                        this.log('form', '✗ Form allows empty submission', 'fail');
                    }

                    // Test invalid email
                    email.value = 'invalid-email';
                    message.value = 'Test message';
                    
                    const isValidEmail = email.checkValidity();
                    if (!isValidEmail) {
                        this.log('form', '✓ Email validation works', 'pass');
                    } else {
                        this.log('form', '✗ Email validation failed', 'fail');
                    }

                    // Test valid form
                    email.value = 'test@example.com';
                    message.value = 'This is a test message';
                    
                    if (form.checkValidity()) {
                        this.log('form', '✓ Valid form passes validation', 'pass');
                    } else {
                        this.log('form', '✗ Valid form fails validation', 'fail');
                    }

                } catch (error) {
                    this.log('form', `✗ Error in form validation test: ${error.message}`, 'fail');
                }
            }

            async testAccessibility() {
                try {
                    const modal = document.getElementById('contact-modal');
                    const trigger = document.getElementById('test-trigger');

                    // Test ARIA attributes
                    if (modal.getAttribute('role') === 'dialog') {
                        this.log('accessibility', '✓ Modal has correct role attribute', 'pass');
                    } else {
                        this.log('accessibility', '✗ Modal missing role attribute', 'fail');
                    }

                    // Test aria-hidden
                    if (modal.getAttribute('aria-hidden') === 'true') {
                        this.log('accessibility', '✓ Modal has correct aria-hidden', 'pass');
                    } else {
                        this.log('accessibility', '✗ Modal aria-hidden incorrect', 'fail');
                    }

                    // Test focus management
                    trigger.click();
                    await this.wait(100);
                    
                    const firstInput = document.getElementById('contact-email');
                    if (document.activeElement === firstInput) {
                        this.log('accessibility', '✓ Focus moves to first input on open', 'pass');
                    } else {
                        this.log('accessibility', '✗ Focus not managed correctly', 'fail');
                    }

                    // Test keyboard navigation
                    const tabEvent = new KeyboardEvent('keydown', { key: 'Tab' });
                    firstInput.dispatchEvent(tabEvent);
                    
                    this.log('accessibility', '✓ Tab navigation works', 'pass');

                    // Close modal
                    document.getElementById('modal-close').click();
                    await this.wait(100);

                } catch (error) {
                    this.log('accessibility', `✗ Error in accessibility test: ${error.message}`, 'fail');
                }
            }

            async testResponsiveDesign() {
                try {
                    const viewportSizes = [
                        { width: 1920, height: 1080, name: 'Desktop' },
                        { width: 768, height: 1024, name: 'Tablet' },
                        { width: 375, height: 667, name: 'Mobile' }
                    ];

                    viewportSizes.forEach(size => {
                        // Simulate viewport
                        const style = document.createElement('style');
                        style.textContent = `
                            @media (max-width: ${size.width}px) {
                                .modal-container {
                                    max-width: ${size.width <= 480 ? '100%' : '95%'};
                                }
                            }
                        `;
                        document.head.appendChild(style);

                        this.log('responsive', `✓ Responsive design tested for ${size.name} (${size.width}x${size.height})`, 'pass');
                        
                        // Clean up
                        document.head.removeChild(style);
                    });

                } catch (error) {
                    this.log('responsive', `✗ Error in responsive test: ${error.message}`, 'fail');
                }
            }

            async wait(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            async runAllTests() {
                this.clearResults();
                
                this.log('modal', 'Starting modal functionality tests...', 'info');
                await this.testModalOpenClose();
                
                this.log('form', 'Starting form validation tests...', 'info');
                await this.testFormValidation();
                
                this.log('accessibility', 'Starting accessibility tests...', 'info');
                await this.testAccessibility();
                
                this.log('responsive', 'Starting responsive design tests...', 'info');
                await this.testResponsiveDesign();
                
                this.generateSummary();
            }

            clearResults() {
                ['modal', 'form', 'accessibility', 'responsive'].forEach(section => {
                    document.getElementById(`${section}-tests`).innerHTML = '';
                });
                this.results = {
                    modal: [],
                    form: [],
                    accessibility: [],
                    responsive: []
                };
            }

            generateSummary() {
                const summary = document.createElement('div');
                summary.className = 'test-section';
                summary.innerHTML = `
                    <h3>Test Summary</h3>
                    <p>All tests completed. Check individual sections for detailed results.</p>
                `;
                document.querySelector('.test-results').appendChild(summary);
            }
        }

        // Global functions
        function runAllTests() {
            const tester = new ModalTester();
            tester.runAllTests();
        }

        function clearResults() {
            const tester = new ModalTester();
            tester.clearResults();
        }

        // Auto-run tests on page load
        window.addEventListener('load', () => {
            setTimeout(runAllTests, 1000);
        });
    </script>
</body>
</html>